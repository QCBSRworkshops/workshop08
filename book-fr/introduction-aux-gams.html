<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R</title>
  <meta name="description" content="Modèles additifs généralisés en R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles additifs généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop08" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R" />
  
  <meta name="twitter:description" content="Modèles additifs généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et maintenu par les contributeurs et contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="intro-linear-models.html"/>
<link rel="next" href="fonctionnement.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduit"><i class="fa fa-check"></i><b>0.1</b> Code de conduit</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles additifs généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>3</b> Le modèle linéaire… et où il échoue</a></li>
<li class="chapter" data-level="4" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html"><i class="fa fa-check"></i><b>4</b> Introduction aux GAMs</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#test-de-linéarité"><i class="fa fa-check"></i><b>4.1</b> Test de linéarité</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#défi-1"><i class="fa fa-check"></i><b>4.2</b> Défi 1</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#défi-1-solution"><i class="fa fa-check"></i><b>4.2.1</b> Défi 1: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fonctionnement.html"><a href="fonctionnement.html"><i class="fa fa-check"></i><b>5</b> Le fonctionnement des GAMs</a><ul>
<li class="chapter" data-level="5.1" data-path="fonctionnement.html"><a href="fonctionnement.html#exemple-une-base-polynomiale"><i class="fa fa-check"></i><b>5.1</b> Exemple: une base polynomiale</a></li>
<li class="chapter" data-level="5.2" data-path="fonctionnement.html"><a href="fonctionnement.html#exemple-une-base-de-spline-cubique"><i class="fa fa-check"></i><b>5.2</b> Exemple: une base de spline cubique</a><ul>
<li class="chapter" data-level="5.2.1" data-path="fonctionnement.html"><a href="fonctionnement.html#contrôler-le-degré-de-lissage-avec-des-splines-de-régression-pénalisés"><i class="fa fa-check"></i><b>5.2.1</b> Contrôler le degré de lissage avec des splines de régression pénalisés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html"><i class="fa fa-check"></i><b>6</b> GAM avec plusieurs termes non-linéaires</a><ul>
<li class="chapter" data-level="6.1" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#gam-à-plusieurs-variables"><i class="fa fa-check"></i><b>6.1</b> GAM à plusieurs variables</a></li>
<li class="chapter" data-level="6.2" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#degrés-de-liberté-effectifs-edf"><i class="fa fa-check"></i><b>6.2</b> Degrés de liberté effectifs (edf)</a></li>
<li class="chapter" data-level="6.3" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#gam-à-plusieurs-variables-linéaires-et-lisses"><i class="fa fa-check"></i><b>6.3</b> GAM à plusieurs variables linéaires et lisses</a></li>
<li class="chapter" data-level="6.4" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#gam-à-plusieurs-variables-1"><i class="fa fa-check"></i><b>6.4</b> GAM à plusieurs variables</a></li>
<li class="chapter" data-level="6.5" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#défi-2"><i class="fa fa-check"></i><b>6.5</b> Défi 2</a><ul>
<li class="chapter" data-level="6.5.1" data-path="gam-avec-plusieurs-termes-non-linéaires.html"><a href="gam-avec-plusieurs-termes-non-linéaires.html#défi-2-solution"><i class="fa fa-check"></i><b>6.5.1</b> Défi 2: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>7</b> Interactions</a></li>
<li class="part"><span><b>Concepts Avancés</b></span></li>
<li class="chapter" data-level="8" data-path="changer-la-fonction-de-base.html"><a href="changer-la-fonction-de-base.html"><i class="fa fa-check"></i><b>8</b> Changer la fonction de base</a></li>
<li class="chapter" data-level="9" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>9</b> Autres distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="autres-distributions.html"><a href="autres-distributions.html#visualiser-la-tendance-au-fil-du-temps"><i class="fa fa-check"></i><b>9.1</b> Visualiser la tendance au fil du temps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><i class="fa fa-check"></i><b>10</b> Intro rapide aux modèles additifs généralisés à effets mixtes (GAMMs)</a><ul>
<li class="chapter" data-level="10.1" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#la-non-indépendance-des-données"><i class="fa fa-check"></i><b>10.1</b> La non-indépendance des données</a></li>
<li class="chapter" data-level="10.2" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#modélisation-avec-effets-mixtes"><i class="fa fa-check"></i><b>10.2</b> Modélisation avec effets mixtes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ressources.html"><a href="ressources.html"><i class="fa fa-check"></i><b>11</b> Ressources</a></li>
<li class="chapter" data-level="12" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>12</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 8 : Modèles additifs généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="introduction-aux-gams" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Introduction aux GAMs</h1>
<p>Utilisons un exemple pour démontrer la différence entre une régression linéaire et un modèle additif.</p>
<p>Nous allons utiliser le jeu de données <code>ISIT</code>. Ce jeu de donnée comporte des mesures de bioluminescence en relation à la profondeur (<em>depth</em>), la station de rechercher et la saison (<em>Season</em>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction-aux-gams.html#cb2-1"></a>isit &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/ISIT.csv&quot;</span>)</span>
<span id="cb2-2"><a href="introduction-aux-gams.html#cb2-2"></a><span class="kw">head</span>(isit)</span></code></pre></div>
<pre><code>##   SampleDepth Sources Station Time Latitude Longitude     Xkm    Ykm Month Year
## 1         517   28.73       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
## 2         582   27.90       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
## 3         547   23.44       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
## 4         614   18.33       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
## 5        1068   12.38       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
## 6        1005   11.23       1    3  50.1508  -14.4792 -34.106 16.779     4 2001
##   BottomDepth Season Discovery RelativeDepth
## 1        3939      1       252          3422
## 2        3939      1       252          3357
## 3        3939      1       252          3392
## 4        3939      1       252          3325
## 5        3939      1       252          2871
## 6        3939      1       252          2934</code></pre>
<p>Prenons que les données de la deuxième saison pour l’instant:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="introduction-aux-gams.html#cb4-1"></a>isit2 &lt;-<span class="st"> </span><span class="kw">subset</span>(isit, Season <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<p>Commençons par essayer d’ajuster un modèle de régression linéaire à la relation entre <code>Sources</code> et <code>SampleDepth</code>. Nous pouvons utiliser la commande <code>gam()</code> de la librairie <code>mgcv</code> pour modéliser une régression par les moindres carrés. Nous verrons plus loin comment utiliser <code>gam()</code> pour spécifier un terme lissé et non linéaire.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="introduction-aux-gams.html#cb5-1"></a>linear_model &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span>SampleDepth, <span class="dt">data =</span> isit2)</span>
<span id="cb5-2"><a href="introduction-aux-gams.html#cb5-2"></a><span class="kw">summary</span>(linear_model)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Sources ~ SampleDepth
## 
## Parametric coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.9021874  0.7963891   38.80   &lt;2e-16 ***
## SampleDepth -0.0083450  0.0003283  -25.42   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## R-sq.(adj) =  0.588   Deviance explained = 58.9%
## GCV =  60.19  Scale est. = 59.924    n = 453</code></pre>
<p>Le modèle linéaire explique une bonne partie de la variance de notre jeu de données (<span class="math inline">\(R_{adj}\)</span> = 0.588), ce qui veut dire que notre modèle est super bon, non? Voyons comment notre modèle cadre avec les données:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="introduction-aux-gams.html#cb7-1"></a>data_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> isit2, <span class="kw">aes</span>(<span class="dt">y =</span> Sources, <span class="dt">x =</span> SampleDepth)) <span class="op">+</span></span>
<span id="cb7-2"><a href="introduction-aux-gams.html#cb7-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(linear_model)), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb7-3"><a href="introduction-aux-gams.html#cb7-3"></a>    <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb7-4"><a href="introduction-aux-gams.html#cb7-4"></a>data_plot</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Les suppositions de la régression linéaire énumérées dans le <a href="intro-linear-models.html#intro-linear-models">Chapitre 4</a> sont-elles satisfaites dans ce cas? Comme vous l’avez peut-être remarqué, nous ne respectons pas les conditions du modèle linéaire:</p>
<ol style="list-style-type: decimal">
<li>Il existe une forte relation <em>non linéaire</em> entre <code>Sources</code> et <code>SampleDepth</code>.</li>
<li>L’erreur n’est <em>pas</em> normalement distribuée.</li>
<li>La variance de l’erreur n’est <em>pas</em> homoscédastique.</li>
<li>Les erreurs ne sont <em>pas</em> indépendantes les unes des autres.</li>
</ol>
<p>Comme nous l’avons brièvement mentionné au <a href="intro-linear-models.html#intro-linear-models">Chapitre 2</a>, nous pouvons spécifier manuellement un modèle linéaire avec plusieurs variables prédicteurs pour essayer de prendre en compte cette réponse non linéaire. Par exemple, nous pourrions essayer de construire ce modèle linéaire avec plusieurs prédicteurs:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1(x_{1,i}) + \beta_2(x_{2,i}) + ... + \epsilon\]</span>
Cependant, l’ajustement de ce modèle serait déterminé manuellement sur la base de décisions prises lors de la modélisation, et deviendrait rapidement difficile à utiliser. Un des grands avantages d’utiliser un GAM est que la forme optimale de la non-linéarité, i.e. <strong>le degré de lissage</strong> de <span class="math inline">\(f(x)\)</span> est contrôlée en utilisant une régression pénalisée qui est déterminée automatiquement est déterminée automatiquement selon la méthode d’ajustement (généralement le <em>maximum de vraisemblance</em> ou <em>maximum likelihood</em>).</p>
<div class="explanation">
<p>Nous reviendrons sur ceci un peu plus tard, mais brièvement, les GAMs
sont une forme non paramétrique de la régression où le
<span class="math inline">\(\beta x_i\)</span> d’une régression linéaire est remplacé par une
fonction de lissage des variables explicatives, <span class="math inline">\(f(x_i)\)</span>, et le modèle
devient :</p>
<p><span class="math display">\[y_i = f(x_i) + \epsilon_i\]</span></p>
<p>où <span class="math inline">\(y_i\)</span> est la variable réponse, <span class="math inline">\(x_i\)</span> est la covariable, et <span class="math inline">\(f\)</span> est la
fonction lissage.</p>
<p>Étant donné que la fonction de lissage <span class="math inline">\(f(x_i)\)</span> est non linéaire et
locale, l’ampleur de l’effet de la variable explicative peut varier en
fonction de la relation entre la variable et la réponse. Autrement dit,
contrairement à un coefficient fixe <span class="math inline">\(\beta x_i\)</span>, la fonction <span class="math inline">\(f\)</span>
peut changer tout au long du gradient <span class="math inline">\(x_i\)</span>. Le degré de lissage de <span class="math inline">\(f\)</span>
est contrôlée en utilisant une régression pénalisée qui est déterminée
automatiquement à l’aide d’une méthode de validation croisée
généralisée (GCV) de la librairie <code>mgcv</code> <span class="citation">(Wood <a href="#ref-wood_2006" role="doc-biblioref">2006</a>)</span>.</p>
</div>
<p>Nous pouvons essayer de construire un modèle plus approprié en ajustant les données avec un terme lissé (non-linéaire). Dans <code>mgcv::gam()</code>, les termes lissés sont spécifiés par des expressions de la forme <code>s(x)</code>, où <span class="math inline">\(x\)</span> est la variable prédictive non linéaire que nous voulons lisser. Dans ce cas, nous voulons appliquer une fonction de lissage à <code>SampleDepth</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="introduction-aux-gams.html#cb8-1"></a>gam_model &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth), <span class="dt">data =</span> isit2)</span>
<span id="cb8-2"><a href="introduction-aux-gams.html#cb8-2"></a><span class="kw">summary</span>(gam_model)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Sources ~ s(SampleDepth)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  12.8937     0.2471   52.17   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                  edf Ref.df     F p-value    
## s(SampleDepth) 8.908  8.998 214.1  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =   0.81   Deviance explained = 81.4%
## GCV = 28.287  Scale est. = 27.669    n = 453</code></pre>
<p>La variance expliquée par notre modèle a augmenté de plus de 20% (<span class="math inline">\(R_{adj}\)</span> = 0.81)! Lorsque nous comparons l’ajustement des modèles linéaire (rouge) et non linéaire (bleu), il est clair que ce dernier cadre mieux avec nos données:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction-aux-gams.html#cb10-1"></a>data_plot &lt;-<span class="st"> </span>data_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(gam_model)),</span>
<span id="cb10-2"><a href="introduction-aux-gams.html#cb10-2"></a>    <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</span>
<span id="cb10-3"><a href="introduction-aux-gams.html#cb10-3"></a>data_plot</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="explanation">
<p>Rappel: Contrairement à un coefficient fixe <span class="math inline">\(\beta\)</span>, la fonction de lissage peut changer tout au long du gradient <span class="math inline">\(x\)</span>.</p>
</div>
<p>La librairie <code>mgcv</code> comprend également une fonction <code>plot</code> qui, par
défaut, nous permet de visualiser la non-linéarité du modèle.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="introduction-aux-gams.html#cb11-1"></a><span class="kw">plot</span>(gam_model)</span></code></pre></div>
<div id="test-de-linéarité" class="section level2">
<h2><span class="header-section-number">4.1</span> Test de linéarité</h2>
<p>Comment tester si le modèle non linéaire offre une amélioration significative par rapport au modèle linéaire?</p>
<p>On peut utiliser <code>gam()</code> et <code>AIC()</code> pour tester si une supposition de linéarité est justifiée. Pour ceci, on peut comparer la performance d’un modèle linéaire contenant <code>x</code> comme prédicteur linéaire à la performance d’un modèle non linéaire contenant <code>s(x)</code> comme prédicteur lisse. En d’autres termes, on demande si l’ajout d’une fonction lisse au modèle linéaire améliore l’ajustement du modèle à nos données.
Comment utilisons-nous les GAMs pour savoir si un modèle linéaire est
suffisant pour modéliser nos données?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="introduction-aux-gams.html#cb12-1"></a>linear_model &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span>SampleDepth, <span class="dt">data =</span> isit2)</span>
<span id="cb12-2"><a href="introduction-aux-gams.html#cb12-2"></a>smooth_model &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth), <span class="dt">data =</span> isit2)</span>
<span id="cb12-3"><a href="introduction-aux-gams.html#cb12-3"></a><span class="kw">AIC</span>(linear_model, smooth_model)</span></code></pre></div>
<pre><code>##                    df      AIC
## linear_model  3.00000 3143.720
## smooth_model 10.90825 2801.451</code></pre>
<p>Ici, l’AIC du GAM lissé est plus bas, ce qui indique que l’ajout d’une fonction de lissage améliore la performance du modèle. La linéarité n’est donc pas soutenue par nos données.</p>
<div class="explanation">
<p>Pour expliquer brièvement, le critère d’information d’Akaike (AIC) est une mesure comparative de la performance d’un modèle, où des valeurs plus basses indiquent qu’un modèle est “plus performant” par rapport aux autres modèles considérés.</p>
</div>
</div>
<div id="défi-1" class="section level2">
<h2><span class="header-section-number">4.2</span> Défi 1</h2>
<p>Essayons maintenant de déterminer si les données enregistrées lors de la première saison doivent être modélisées par une régression linéaire ou par un modèle additif. Répétons le test de comparaison avec <code>gam()</code> et <code>AIC()</code> en utilisant les données de la première saison seulement:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="introduction-aux-gams.html#cb14-1"></a>isit1 &lt;-<span class="st"> </span><span class="kw">subset</span>(isit, Season <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Ajustez un modèle linéaire et un GAM à la relation entre <code>Sources</code> et <code>SampleDepth</code>.</li>
<li>Déterminez si l’hypothèse de linéarité est justifiée pour ces données.</li>
<li>Quels sont les degrés de liberté effectifs du terme non-linéaire?</li>
</ol>
<div class="explanation">
<p>Nous n’avons pas encore discuté des degrés de liberté effectifs (<strong>EDF</strong>), mais ils sont un outil clé pour nous aider à interpréter l’ajustement d’un GAM. Gardez ce terme en tête. Plus sur ce sujet dans les prochaines sections!</p>
</div>
<div id="défi-1-solution" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Défi 1: Solution</h3>
<p><strong>1.</strong> Ajustez un modèle linéaire et un GAM à la relation entre <code>Sources</code> et <code>SampleDepth</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="introduction-aux-gams.html#cb15-1"></a>linear_model_s1 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span>SampleDepth, <span class="dt">data =</span> isit1)</span>
<span id="cb15-2"><a href="introduction-aux-gams.html#cb15-2"></a>smooth_model_s1 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth), <span class="dt">data =</span> isit1)</span></code></pre></div>
<p><strong>2.</strong> Déterminez si l’hypothèse de linéarité est justifiée pour ces données.</p>
<p>Comme ci-dessus, la visualisation de la courbe du modèle sur notre ensemble de données est une excellente première étape pour déterminer si notre modèle est bien conçu.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="introduction-aux-gams.html#cb16-1"></a><span class="kw">ggplot</span>(isit1, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> Sources)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb16-2"><a href="introduction-aux-gams.html#cb16-2"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(linear_model_s1))) <span class="op">+</span></span>
<span id="cb16-3"><a href="introduction-aux-gams.html#cb16-3"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(smooth_model_s1))) <span class="op">+</span></span>
<span id="cb16-4"><a href="introduction-aux-gams.html#cb16-4"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>On peut compléter cela par une comparaison quantitative des performances du modèle en utilisant <code>AIC()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="introduction-aux-gams.html#cb17-1"></a><span class="kw">AIC</span>(linear_model_s1, smooth_model_s1)</span></code></pre></div>
<pre><code>##                       df      AIC
## linear_model_s1 3.000000 2324.905
## smooth_model_s1 9.644938 2121.249</code></pre>
<p>Le score AIC moins élevé indique que le modèle lissé est plus performant que le modèle linéaire, ce qui confirme que la linéarité n’est pas appropriée pour notre ensemble de données.</p>
<p><strong>3.</strong> Quels sont les degrés de liberté effectifs du terme non-linéaire?</p>
<p>Pour obtenir les degrés de liberté effectifs, il suffit d’imprimer notre objet du modèle:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="introduction-aux-gams.html#cb19-1"></a>smooth_model_s1</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Sources ~ s(SampleDepth)
## 
## Estimated degrees of freedom:
## 7.64  total = 8.64 
## 
## GCV score: 32.13946</code></pre>
<p>Les degrés de liberté effectifs (EDF) sont &gt;&gt; 1. Gardez cela à l’esprit, car nous reviendrons bientôt sur ceux-ci!</p>

</div>
</div>
</div>
<h3> Réferences</h3>
<div id="refs" class="references">
<div id="ref-wood_2006">
<p>Wood, S. N. 2006. <em>Generalized Additive Models: An Introduction with R</em>. 2nd ed. Chapman; Hall/CRC.</p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="intro-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fonctionnement.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
