<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 5 Plusieurs termes non linéaires | Atelier 8 : Modèles additifs généralisés en R</title>
  <meta name="description" content="Modèles additifs généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 5 Plusieurs termes non linéaires | Atelier 8 : Modèles additifs généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles additifs généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop08" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 5 Plusieurs termes non linéaires | Atelier 8 : Modèles additifs généralisés en R" />
  
  <meta name="twitter:description" content="Modèles additifs généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et maintenu par les contributeurs et contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="introduction-aux-gams.html"/>
<link rel="next" href="interactions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduit"><i class="fa fa-check"></i><b>0.1</b> Code de conduit</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles additifs généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Résumé et Objectifs d’apprentissage</a><ul>
<li class="chapter" data-level="1.1" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html#résumé"><i class="fa fa-check"></i><b>1.1</b> Résumé</a></li>
<li class="chapter" data-level="1.2" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html#objectifs-dapprentissage"><i class="fa fa-check"></i><b>1.2</b> Objectifs d’apprentissage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="le-modèle-linéaireet-où-il-échoue.html"><a href="le-modèle-linéaireet-où-il-échoue.html"><i class="fa fa-check"></i><b>3</b> Le modèle linéaire…et où il échoue</a></li>
<li class="chapter" data-level="4" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html"><i class="fa fa-check"></i><b>4</b> Introduction aux GAMs</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#défi-1"><i class="fa fa-check"></i><b>4.1</b> DÉFI 1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#réponse-au-défi-1"><i class="fa fa-check"></i><b>4.1.1</b> Réponse au défi 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html"><i class="fa fa-check"></i><b>5</b> Plusieurs termes non linéaires</a><ul>
<li class="chapter" data-level="5.1" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html#défi-2"><i class="fa fa-check"></i><b>5.1</b> DÉFI 2</a><ul>
<li class="chapter" data-level="5.1.1" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html#réponse-au-défi-2"><i class="fa fa-check"></i><b>5.1.1</b> Réponse au défi 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>6</b> Interactions</a></li>
<li class="part"><span><b>Concepts Avancés</b></span></li>
<li class="chapter" data-level="7" data-path="changer-la-fonction-de-base.html"><a href="changer-la-fonction-de-base.html"><i class="fa fa-check"></i><b>7</b> Changer la fonction de base</a></li>
<li class="chapter" data-level="8" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>8</b> Autres distributions</a><ul>
<li class="chapter" data-level="8.1" data-path="autres-distributions.html"><a href="autres-distributions.html#visualiser-la-tendance-au-fil-du-temps"><i class="fa fa-check"></i><b>8.1</b> Visualiser la tendance au fil du temps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><i class="fa fa-check"></i><b>9</b> Intro rapide aux modèles additifs généralisés à effets mixtes (GAMMs)</a><ul>
<li class="chapter" data-level="9.1" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#la-non-indépendance-des-données"><i class="fa fa-check"></i><b>9.1</b> La non-indépendance des données</a></li>
<li class="chapter" data-level="9.2" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#modélisation-avec-effets-mixtes"><i class="fa fa-check"></i><b>9.2</b> Modélisation avec effets mixtes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html"><i class="fa fa-check"></i><b>10</b> Les GAMs en coulisse</a><ul>
<li class="chapter" data-level="10.1" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#un-exemple-simple-une-base-polynomiale"><i class="fa fa-check"></i><b>10.1</b> Un exemple simple : une base polynomiale</a></li>
<li class="chapter" data-level="10.2" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#un-autre-exemple-une-base-de-spline-cubique"><i class="fa fa-check"></i><b>10.2</b> Un autre exemple : une base de spline cubique</a><ul>
<li class="chapter" data-level="10.2.1" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#contrôler-le-degré-de-lissage-avec-des-splines-de-régression-pénalisés"><i class="fa fa-check"></i><b>10.2.1</b> Contrôler le degré de lissage avec des splines de régression pénalisés</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#illustration-du-principe-de-validation-croisée"><i class="fa fa-check"></i><b>10.3</b> Illustration du principe de validation croisée</a></li>
<li class="chapter" data-level="10.4" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#note-supplémentaire-sur-les-degrés-de-liberté-effectifs-edf"><i class="fa fa-check"></i><b>10.4</b> Note supplémentaire sur les degrés de liberté effectifs (edf)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 8 : Modèles additifs généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="plusieurs-termes-non-linéaires" class="section level1">
<h1><span class="header-section-number">Chapitre 5</span> Plusieurs termes non linéaires</h1>
<p>Avec les GAMs, il est facile d’ajouter des termes non linéaires et
linéaires dans un seul modèle, plusieurs termes non linéaires ou même
des interactions non linéaires. Dans cette section, nous allons utiliser
un ensemble de données générées automatiquement par <code>mgcv</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="plusieurs-termes-non-linéaires.html#cb12-1"></a>gam_data =<span class="st"> </span><span class="kw">gamSim</span>(<span class="dt">eg =</span> <span class="dv">5</span>)</span>
<span id="cb12-2"><a href="plusieurs-termes-non-linéaires.html#cb12-2"></a><span class="kw">head</span>(gam_data)</span></code></pre></div>
<p>Nous allons voir comment nous pouvons prédire la variable réponse <code>y</code> en
fonction des autres variables. Commençons par un modèle de base
comprenant un terme non linéaire (<code>x1</code>) et un facteur qualitatif (<code>X0</code> avec
4 niveaux).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="plusieurs-termes-non-linéaires.html#cb13-1"></a>basic_model =<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span>x0 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x1), <span class="dt">data =</span> gam_data)</span>
<span id="cb13-2"><a href="plusieurs-termes-non-linéaires.html#cb13-2"></a>basic_summary =<span class="st"> </span><span class="kw">summary</span>(basic_model)</span>
<span id="cb13-3"><a href="plusieurs-termes-non-linéaires.html#cb13-3"></a><span class="kw">print</span>(basic_summary<span class="op">$</span>p.table)</span>
<span id="cb13-4"><a href="plusieurs-termes-non-linéaires.html#cb13-4"></a><span class="kw">print</span>(basic_summary<span class="op">$</span>s.table)</span>
<span id="cb13-5"><a href="plusieurs-termes-non-linéaires.html#cb13-5"></a><span class="kw">plot</span>(basic_model)</span></code></pre></div>
<p>Ici, la sortie de <code>p.table</code> fournit le tableau de résultats pour chaque
terme paramétrique et le tableau <code>s.table</code> nous donne les résultats du
terme non linéaire. Notez que pour le second tableau, la courbure du
terme non linéaire <code>s(X1)</code> est indiquée par le paramètre edf (degrés de
libertés effectifs); plus la valeur de l’edf est élevée, plus la
non-linéarité est forte. Une valeur élevée (8-10 ou plus) signifie que
la courbe est fortement non linéaire, alors qu’une courbe avec un edf
égal à 1 est une ligne droite. En revanche, dans la régression linéaire,
les degrés de libertés du <em>modèle</em> sont équivalents au nombre de
paramètres libres non redondants <em>p</em> dans le modèle (et les degrés de
libertés <em>résiduels</em> sont égaux à <em>n-p</em>). Nous reviendrons plus tard sur
le concept d’edf.</p>
<pre><code> print(basic_summary$p.table)
             Estimate Std. Error   t value     Pr(&gt;|t|)
 (Intercept) 8.550030  0.3655849 23.387258 1.717989e-76
 x02         2.418682  0.5165515  4.682364 3.908046e-06
 x03         4.486193  0.5156501  8.700072 9.124666e-17
 x04         6.528518  0.5204234 12.544629 1.322632e-30
 &gt; print(basic_summary$s.table)
            edf   Ref.df        F      p-value
 s(x1) 1.923913 2.406719 42.84268 1.076396e-19</code></pre>
<p>Dans notre modèle de base, l’edf du terme non linéaire <code>s(x1)</code> est ~ 2,
ce qui indique une courbe non linéaire. Le graphique du modèle illustre
bien la forme de ce terme non linéaire :</p>
<p><img src="images/graphic2.2.jpg" width="425" /></p>
<p>Nous pouvons ajouter un second terme <code>x2</code>, mais spécifier une relation
linéaire avec Y (<em>i.e.</em> les GAMs peuvent inclure à la fois des termes
linéaires et non linéaires dans le même modèle). Ce nouveau terme
linéaire <code>x2</code> sera présenté dans le tableau <code>p.table</code>, pour lequel une
estimation du coefficient de régression sera indiquée. Dans le tableau
<code>s.table</code>, nous retrouvons encore une fois le terme non linéaire <code>s(x1)</code>
et son paramètre de courbure.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="plusieurs-termes-non-linéaires.html#cb15-1"></a>two_term_model &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span>x0 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x1) <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> gam_data)</span>
<span id="cb15-2"><a href="plusieurs-termes-non-linéaires.html#cb15-2"></a>two_term_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(two_term_model)</span>
<span id="cb15-3"><a href="plusieurs-termes-non-linéaires.html#cb15-3"></a><span class="kw">print</span>(two_term_summary<span class="op">$</span>p.table)</span>
<span id="cb15-4"><a href="plusieurs-termes-non-linéaires.html#cb15-4"></a><span class="kw">print</span>(two_term_summary<span class="op">$</span>s.table)</span></code></pre></div>
<p>Pour évaluer si la relation entre <code>y</code> et <code>x2</code> est non linéaire, on peut
modéliser <code>x2</code> avec une fonction non linéaire. Tel que vu auparavant, nous
pouvons utiliser une ANOVA pour tester si le terme non linéaire est
nécessaire.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="plusieurs-termes-non-linéaires.html#cb16-1"></a>two_smooth_model &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span>x0 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x2), <span class="dt">data =</span> gam_data)</span>
<span id="cb16-2"><a href="plusieurs-termes-non-linéaires.html#cb16-2"></a>two_smooth_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(two_smooth_model)</span>
<span id="cb16-3"><a href="plusieurs-termes-non-linéaires.html#cb16-3"></a><span class="kw">print</span>(two_smooth_summary<span class="op">$</span>p.table)</span>
<span id="cb16-4"><a href="plusieurs-termes-non-linéaires.html#cb16-4"></a><span class="kw">print</span>(two_smooth_summary<span class="op">$</span>s.table)</span>
<span id="cb16-5"><a href="plusieurs-termes-non-linéaires.html#cb16-5"></a><span class="kw">plot</span>(two_smooth_model, <span class="dt">page =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="images/graphic2.4.jpg" width="600" /></p>
<p>Lorsqu’il y a plus d’une variable d’incluse dans le modèle, comme
ci-dessus, la réponse ajustée peut-être partitionnée entre les
contributions de chaque variable. Ici, nous pouvons évaluer l’effet de
chaque variable où l’axe des ordonnées représente la contribution
(effet) de chaque covariable à la réponse ajustée centrée sur 0. Si
l’intervalle de confiance chevauche zéro pour certaines valeurs de <em>x</em>,
cela indique que l’effet est non significatif. Lorsque la contribution
varie selon l’axe <em>x</em>, un changement de cette variable cause un
changement de la variable réponse.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="plusieurs-termes-non-linéaires.html#cb17-1"></a><span class="kw">anova</span>(basic_model, two_term_model, two_smooth_model, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>  Analysis of Deviance Table
  Model 1: y ~ x0 + s(x1)
  Model 2: y ~ x0 + s(x1) + x2
  Model 3: y ~ x0 + s(x1) + s(x2)
    Resid. Df Resid. Dev      Df Deviance  Pr(&gt;Chi)    
  1    394.08     5231.6                               
  2    393.10     4051.3 0.97695   1180.2 &lt; 2.2e-16 ***
  3    385.73     1839.5 7.37288   2211.8 &lt; 2.2e-16 ***
  ---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</code></pre>
<p>Le meilleur modèle est le modèle avec deux fonctions non linéaires pour
<code>x1</code> et pour <code>x2</code>.</p>
<div id="défi-2" class="section level2">
<h2><span class="header-section-number">5.1</span> DÉFI 2</h2>
<p>Créez deux nouveaux modèles avec la variable <code>x3</code> : un modèle avec <code>x3</code>
comme paramètre linéaire et un autre modèle avec <code>x3</code> avec un paramètre
non linéaire. Utilisez des graphiques, les tables des coefficients et la
fonction <code>anova()</code> afin de déterminer s’il est nécessaire d’inclure <code>x3</code>
dans le modèle.</p>
<div id="réponse-au-défi-2" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Réponse au défi 2</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="plusieurs-termes-non-linéaires.html#cb19-1"></a>three_term_model &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span>x0 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x2) <span class="op">+</span><span class="st"> </span>x3, <span class="dt">data =</span> gam_data)</span>
<span id="cb19-2"><a href="plusieurs-termes-non-linéaires.html#cb19-2"></a>three_smooth_model &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span>x0 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x2) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x3), <span class="dt">data =</span> gam_data)</span>
<span id="cb19-3"><a href="plusieurs-termes-non-linéaires.html#cb19-3"></a>three_smooth_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(three_smooth_model)</span>
<span id="cb19-4"><a href="plusieurs-termes-non-linéaires.html#cb19-4"></a></span>
<span id="cb19-5"><a href="plusieurs-termes-non-linéaires.html#cb19-5"></a><span class="kw">print</span>(three_smooth_summary<span class="op">$</span>p.table)</span>
<span id="cb19-6"><a href="plusieurs-termes-non-linéaires.html#cb19-6"></a><span class="kw">print</span>(three_smooth_summary<span class="op">$</span>s.table)</span>
<span id="cb19-7"><a href="plusieurs-termes-non-linéaires.html#cb19-7"></a><span class="kw">plot</span>(three_smooth_model, <span class="dt">page =</span> <span class="dv">1</span>)</span>
<span id="cb19-8"><a href="plusieurs-termes-non-linéaires.html#cb19-8"></a><span class="co"># edf = 1 -&gt; le terme est donc linéaire.</span></span>
<span id="cb19-9"><a href="plusieurs-termes-non-linéaires.html#cb19-9"></a></span>
<span id="cb19-10"><a href="plusieurs-termes-non-linéaires.html#cb19-10"></a><span class="kw">anova</span>(two_smooth_model, three_term_model, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb19-11"><a href="plusieurs-termes-non-linéaires.html#cb19-11"></a><span class="co"># le terme x3 n&#39;est pas significatif</span></span></code></pre></div>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-aux-gams.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
