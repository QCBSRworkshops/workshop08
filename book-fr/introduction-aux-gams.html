<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R</title>
  <meta name="description" content="Modèles additifs généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles additifs généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop08" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Introduction aux GAMs | Atelier 8 : Modèles additifs généralisés en R" />
  
  <meta name="twitter:description" content="Modèles additifs généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et maintenu par les contributeurs et contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="le-modèle-linéaireet-où-il-échoue.html"/>
<link rel="next" href="plusieurs-termes-non-linéaires.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduit"><i class="fa fa-check"></i><b>0.1</b> Code de conduit</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles additifs généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Résumé et Objectifs d’apprentissage</a><ul>
<li class="chapter" data-level="1.1" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html#résumé"><i class="fa fa-check"></i><b>1.1</b> Résumé</a></li>
<li class="chapter" data-level="1.2" data-path="résumé-et-objectifs-dapprentissage.html"><a href="résumé-et-objectifs-dapprentissage.html#objectifs-dapprentissage"><i class="fa fa-check"></i><b>1.2</b> Objectifs d’apprentissage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="le-modèle-linéaireet-où-il-échoue.html"><a href="le-modèle-linéaireet-où-il-échoue.html"><i class="fa fa-check"></i><b>3</b> Le modèle linéaire…et où il échoue</a></li>
<li class="chapter" data-level="4" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html"><i class="fa fa-check"></i><b>4</b> Introduction aux GAMs</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#défi-1"><i class="fa fa-check"></i><b>4.1</b> DÉFI 1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-aux-gams.html"><a href="introduction-aux-gams.html#réponse-au-défi-1"><i class="fa fa-check"></i><b>4.1.1</b> Réponse au défi 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html"><i class="fa fa-check"></i><b>5</b> Plusieurs termes non linéaires</a><ul>
<li class="chapter" data-level="5.1" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html#défi-2"><i class="fa fa-check"></i><b>5.1</b> DÉFI 2</a><ul>
<li class="chapter" data-level="5.1.1" data-path="plusieurs-termes-non-linéaires.html"><a href="plusieurs-termes-non-linéaires.html#réponse-au-défi-2"><i class="fa fa-check"></i><b>5.1.1</b> Réponse au défi 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>6</b> Interactions</a></li>
<li class="part"><span><b>Concepts Avancés</b></span></li>
<li class="chapter" data-level="7" data-path="changer-la-fonction-de-base.html"><a href="changer-la-fonction-de-base.html"><i class="fa fa-check"></i><b>7</b> Changer la fonction de base</a></li>
<li class="chapter" data-level="8" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>8</b> Autres distributions</a><ul>
<li class="chapter" data-level="8.1" data-path="autres-distributions.html"><a href="autres-distributions.html#visualiser-la-tendance-au-fil-du-temps"><i class="fa fa-check"></i><b>8.1</b> Visualiser la tendance au fil du temps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><i class="fa fa-check"></i><b>9</b> Intro rapide aux modèles additifs généralisés à effets mixtes (GAMMs)</a><ul>
<li class="chapter" data-level="9.1" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#la-non-indépendance-des-données"><i class="fa fa-check"></i><b>9.1</b> La non-indépendance des données</a></li>
<li class="chapter" data-level="9.2" data-path="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html"><a href="intro-rapide-aux-modèles-additifs-généralisés-à-effets-mixtes-gamms.html#modélisation-avec-effets-mixtes"><i class="fa fa-check"></i><b>9.2</b> Modélisation avec effets mixtes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html"><i class="fa fa-check"></i><b>10</b> Les GAMs en coulisse</a><ul>
<li class="chapter" data-level="10.1" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#un-exemple-simple-une-base-polynomiale"><i class="fa fa-check"></i><b>10.1</b> Un exemple simple : une base polynomiale</a></li>
<li class="chapter" data-level="10.2" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#un-autre-exemple-une-base-de-spline-cubique"><i class="fa fa-check"></i><b>10.2</b> Un autre exemple : une base de spline cubique</a><ul>
<li class="chapter" data-level="10.2.1" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#contrôler-le-degré-de-lissage-avec-des-splines-de-régression-pénalisés"><i class="fa fa-check"></i><b>10.2.1</b> Contrôler le degré de lissage avec des splines de régression pénalisés</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#illustration-du-principe-de-validation-croisée"><i class="fa fa-check"></i><b>10.3</b> Illustration du principe de validation croisée</a></li>
<li class="chapter" data-level="10.4" data-path="les-gams-en-coulisse.html"><a href="les-gams-en-coulisse.html#note-supplémentaire-sur-les-degrés-de-liberté-effectifs-edf"><i class="fa fa-check"></i><b>10.4</b> Note supplémentaire sur les degrés de liberté effectifs (edf)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 8 : Modèles additifs généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="introduction-aux-gams" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Introduction aux GAMs</h1>
<p>Examinons un exemple. Premièrement, nous allons générer des données et
les représenter graphiquement.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="introduction-aux-gams.html#cb3-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="introduction-aux-gams.html#cb3-2"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb3-3"><a href="introduction-aux-gams.html#cb3-3"></a>n =<span class="st"> </span><span class="dv">250</span></span>
<span id="cb3-4"><a href="introduction-aux-gams.html#cb3-4"></a>x =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb3-5"><a href="introduction-aux-gams.html#cb3-5"></a>y_model =<span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x)</span>
<span id="cb3-6"><a href="introduction-aux-gams.html#cb3-6"></a>y_obs =<span class="st"> </span><span class="kw">rnorm</span>(n, y_model, <span class="fl">0.1</span>)</span>
<span id="cb3-7"><a href="introduction-aux-gams.html#cb3-7"></a>data_plot =<span class="st"> </span><span class="kw">qplot</span>(x, y_obs) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> y_model)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb3-8"><a href="introduction-aux-gams.html#cb3-8"></a><span class="kw">print</span>(data_plot)</span></code></pre></div>
<p><img src="images/graphic1.1.jpg" width="350" /></p>
<p>Si nous modélisions cette relation par une régression linéaire, les
résultats ne respecteraient pas les suppositions énumérées ci-dessus.
Commençons par modéliser une régression en utilisant la méthode des
moindres carrés en utilisant la fonction <code>gam()</code> de la librairie <code>mgcv</code>
- donc en tant que modèle linéaire <em>(nous verrons plus bas comment
utiliser cette fonction pour spécifier un terme non linéaire).</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="introduction-aux-gams.html#cb4-1"></a><span class="kw">library</span>(mgcv)</span>
<span id="cb4-2"><a href="introduction-aux-gams.html#cb4-2"></a>linear_model =<span class="st"> </span><span class="kw">gam</span>(y_obs <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb4-3"><a href="introduction-aux-gams.html#cb4-3"></a>model_summary =<span class="st"> </span><span class="kw">summary</span>(linear_model)</span>
<span id="cb4-4"><a href="introduction-aux-gams.html#cb4-4"></a><span class="kw">print</span>(model_summary)</span>
<span id="cb4-5"><a href="introduction-aux-gams.html#cb4-5"></a>data_plot =<span class="st"> </span>data_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(linear_model)))</span>
<span id="cb4-6"><a href="introduction-aux-gams.html#cb4-6"></a><span class="kw">print</span>(data_plot)</span></code></pre></div>
<p>Nous pouvons constater à partir du sommaire que notre modèle linéaire
explique une grande partie de la variance (<em>R<sup>2</sup><sub>adj</sub></em> = 0.639).
Toutefois, les graphiques de diagnostic des résidus du modèle montrent
que l’écart type ne suit pas une distribution normale et que la
variance n’est pas homoscédastique. De plus, il reste un patron
non-linéaire important. Essayons maintenant de résoudre ce problème en
ajustant les données avec un terme non linéaire.</p>
<p>Nous reviendrons sur ceci un peu plus tard, mais brièvement, les GAMs
sont une forme non paramétrique de la régression où le
<em>βx<sub>i</sub></em> d’une régression linéaire est remplacé par une
fonction de lissage des variables explicatives, <em>f(x<sub>i</sub>)</em>, et le modèle
devient :</p>
<p><span class="math display">\[y_i = f(x_i) + ε_i\]</span></p>
<p>où <em>y<sub>i</sub></em> est la variable réponse, <em>x<sub>i</sub></em> est la covariable, et <em>f</em> est la
fonction lissage.</p>
<p>Étant donné que la fonction de lissage <em>f(x<sub>i</sub>)</em> est non linéaire et
locale, l’ampleur de l’effet de la variable explicative peut varier en
fonction de la relation entre la variable et la réponse. Autrement dit,
contrairement à un coefficient fixe <em>βx<sub>i</sub></em>, la fonction <em>f</em>
peut changer tout au long du gradient <em>x<sub>i</sub></em>. Le degré de lissage de <em>f</em>
est contrôlée en utilisant une régression pénalisée qui est déterminée
automatiquement à l’aide d’une méthode de validation croisée
généralisée (GCV) de la librairie <code>mgcv</code> (Wood 2006).</p>
<p>Avec <code>gam()</code> les termes non linéaires sont spécifiés par des expressions
de la forme: <code>s(x)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="introduction-aux-gams.html#cb5-1"></a>gam_model =<span class="st"> </span><span class="kw">gam</span>(y_obs <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x))</span>
<span id="cb5-2"><a href="introduction-aux-gams.html#cb5-2"></a><span class="kw">summary</span>(gam_model)</span>
<span id="cb5-3"><a href="introduction-aux-gams.html#cb5-3"></a>data_plot =<span class="st"> </span>data_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(gam_model)))</span>
<span id="cb5-4"><a href="introduction-aux-gams.html#cb5-4"></a><span class="kw">print</span>(data_plot)</span></code></pre></div>
<p>La variance expliquée par notre modèle a augmenté de 20% (<em>R<sup>2</sup><sub>adj</sub></em> =
0.859) et quand on compare l’ajustement du modèle linéaire (rouge) au
modèle non-linéaire (bleu), il est clair que l’ajustement de ce dernier
est relativement meilleur.</p>
<p><img src="images/graphic1.3.jpg" width="350" /></p>
<p>La librairie <code>mgcv</code> comprend également une fonction <code>plot</code> qui, par
défaut, nous permet de visualiser la non-linéarité du modèle.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introduction-aux-gams.html#cb6-1"></a><span class="kw">plot</span>(gam_model)</span></code></pre></div>
<p>Comment utilisons-nous les GAMs pour savoir si un modèle linéaire est
suffisant pour modéliser nos données ? Nous pouvons utiliser les
fonctions <code>gam()</code> et <code>anova()</code> pour tester formellement si une hypothèse
de linéarité est justifiée. Nous devons simplement le configurer de
sorte que notre modèle non-linéaire est emboîté dans notre modèle
linéaire; c’est à dire, nous devons créer un objet qui inclut à la fois
<code>x</code> (linéaire) et <code>s(x)</code> (non-linéaire). En utilisant la fonction
<code>anova()</code>, on vérifie si l’ajout de <code>s(x)</code> au modèle avec seulement <code>x</code>
comme covariable est justifié par les données.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="introduction-aux-gams.html#cb7-1"></a>linear_model =<span class="st"> </span><span class="kw">gam</span>(y_obs <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb7-2"><a href="introduction-aux-gams.html#cb7-2"></a>nested_gam_model =<span class="st"> </span><span class="kw">gam</span>(y_obs <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x) <span class="op">+</span><span class="st"> </span>x)</span>
<span id="cb7-3"><a href="introduction-aux-gams.html#cb7-3"></a><span class="kw">print</span>(<span class="kw">anova</span>(linear_model, nested_gam_model, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>))</span></code></pre></div>
<p>Le terme non linéaire est significatif:</p>
<pre><code> Analysis of Deviance Table
 Model 1: y_obs ~ x
 Model 2: y_obs ~ s(x) + x
       Resid. Df    Resid. Dev     Df        Deviance    Pr(&gt;Chi)    
 1    248.00        6.5846                              
 2    240.68        2.4988         7.3168    4.0858      &lt; 2.2e-16 ***
 ---
 Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</code></pre>
<div id="défi-1" class="section level2">
<h2><span class="header-section-number">4.1</span> DÉFI 1</h2>
<p>Nous allons maintenant essayer cela avec d’autres données générées
aléatoirement. Nous allons d’abord générer les données. Ensuite, nous
allons ajuster un modèle linéaire et un GAM à la relation entre <code>x_test</code>
et <code>y_test_obs</code>. Quels sont les degrés de libertés effectifs du terme
non-linéaire ? Déterminez si l’hypothèse de linéarité est justifiée
pour ces données.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="introduction-aux-gams.html#cb9-1"></a>n &lt;-<span class="st"> </span><span class="dv">250</span></span>
<span id="cb9-2"><a href="introduction-aux-gams.html#cb9-2"></a>x_test &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-5</span>, <span class="dv">5</span>)</span>
<span id="cb9-3"><a href="introduction-aux-gams.html#cb9-3"></a>y_test_fit &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(x_test)</span>
<span id="cb9-4"><a href="introduction-aux-gams.html#cb9-4"></a>y_test_obs &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, y_test_fit, <span class="fl">0.2</span>)</span></code></pre></div>
<div id="réponse-au-défi-1" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Réponse au défi 1</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction-aux-gams.html#cb10-1"></a>data_plot &lt;-<span class="st"> </span><span class="kw">qplot</span>(x_test, y_test_obs) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> y_test_fit)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-2"><a href="introduction-aux-gams.html#cb10-2"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb10-3"><a href="introduction-aux-gams.html#cb10-3"></a><span class="kw">print</span>(data_plot)</span>
<span id="cb10-4"><a href="introduction-aux-gams.html#cb10-4"></a></span>
<span id="cb10-5"><a href="introduction-aux-gams.html#cb10-5"></a>linear_model_test &lt;-<span class="st"> </span><span class="kw">gam</span>(y_test_obs <span class="op">~</span><span class="st"> </span>x_test)</span>
<span id="cb10-6"><a href="introduction-aux-gams.html#cb10-6"></a>nested_gam_model_test &lt;-<span class="st"> </span><span class="kw">gam</span>(y_test_obs <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x_test) <span class="op">+</span><span class="st"> </span>x_test)</span>
<span id="cb10-7"><a href="introduction-aux-gams.html#cb10-7"></a><span class="kw">print</span>(<span class="kw">anova</span>(linear_model_test, nested_gam_model_test, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>))</span>
<span id="cb10-8"><a href="introduction-aux-gams.html#cb10-8"></a></span>
<span id="cb10-9"><a href="introduction-aux-gams.html#cb10-9"></a><span class="kw">summary</span>(nested_gam_model_test)<span class="op">$</span>s.table</span></code></pre></div>
<pre><code>Analysis of Deviance Table


Model 1: y_test_obs ~ x_test
Model 2: y_test_obs ~ s(x_test) + x_test
     Resid. Df   Resid. Dev    Df      Deviance   Pr(&gt;Chi)    
1     248.0      81.09                              
2     240.5      7.46          7.5012   73.629    &lt; 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

               edf   Ref.df        F p-value
s(x_test) 7.602145 8.029057 294.0944       0</code></pre>
<p>Réponse: Oui la non-linéarité est justifiée. Les degrés de libertés
effectifs (edf) sont &gt;&gt; 1.</p>
<p><img src="images/challenge_1_soln.jpg" width="350" /></p>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="le-modèle-linéaireet-où-il-échoue.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plusieurs-termes-non-linéaires.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
