<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Other distributions | Workshop 8: Generalized additive models in R</title>
  <meta name="description" content="Generalized additive models in R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Other distributions | Workshop 8: Generalized additive models in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized additive models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop08" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Other distributions | Workshop 8: Generalized additive models in R" />
  
  <meta name="twitter:description" content="Generalized additive models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="changing-the-basis-function.html"/>
<link rel="next" href="quick-intro-to-generalized-additive-mixed-models-gamms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized Additive Models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>3</b> The linear modelâ€¦ and where it fails</a></li>
<li class="chapter" data-level="4" data-path="introduction-to-gams.html"><a href="introduction-to-gams.html"><i class="fa fa-check"></i><b>4</b> Introduction to GAMs</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-gams.html"><a href="introduction-to-gams.html#test-for-linearity"><i class="fa fa-check"></i><b>4.1</b> Test for linearity</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-gams.html"><a href="introduction-to-gams.html#challenge-1"><i class="fa fa-check"></i><b>4.2</b> Challenge 1</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-gams.html"><a href="introduction-to-gams.html#challenge-1-solution"><i class="fa fa-check"></i><b>4.2.1</b> Challenge 1: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="how-gams-work.html"><a href="how-gams-work.html"><i class="fa fa-check"></i><b>5</b> How GAMs work</a><ul>
<li class="chapter" data-level="5.1" data-path="how-gams-work.html"><a href="how-gams-work.html#example-a-polynomial-basis"><i class="fa fa-check"></i><b>5.1</b> Example: a polynomial basis</a></li>
<li class="chapter" data-level="5.2" data-path="how-gams-work.html"><a href="how-gams-work.html#example-a-cubic-spline-basis"><i class="fa fa-check"></i><b>5.2</b> Example: a cubic spline basis</a><ul>
<li class="chapter" data-level="5.2.1" data-path="how-gams-work.html"><a href="how-gams-work.html#controlling-the-degree-of-smoothing-with-penalized-regression-splines"><i class="fa fa-check"></i><b>5.2.1</b> Controlling the degree of smoothing with penalized regression splines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html"><i class="fa fa-check"></i><b>6</b> GAM with multiple smooth terms</a><ul>
<li class="chapter" data-level="6.1" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#gam-with-linear-and-smooth-terms"><i class="fa fa-check"></i><b>6.1</b> GAM with linear and smooth terms</a></li>
<li class="chapter" data-level="6.2" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#edf"><i class="fa fa-check"></i><b>6.2</b> Effective degrees of freedom (EDF)</a></li>
<li class="chapter" data-level="6.3" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#gam-with-multiple-linear-and-smooth-terms"><i class="fa fa-check"></i><b>6.3</b> GAM with multiple linear and smooth terms</a></li>
<li class="chapter" data-level="6.4" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#gam-with-multiple-smooth-terms-1"><i class="fa fa-check"></i><b>6.4</b> GAM with multiple smooth terms</a></li>
<li class="chapter" data-level="6.5" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#challenge-2"><i class="fa fa-check"></i><b>6.5</b> Challenge 2</a><ul>
<li class="chapter" data-level="6.5.1" data-path="gam-with-multiple-smooth-terms.html"><a href="gam-with-multiple-smooth-terms.html#challenge-2-solution"><i class="fa fa-check"></i><b>6.5.1</b> Challenge 2: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gam-with-interaction-terms.html"><a href="gam-with-interaction-terms.html"><i class="fa fa-check"></i><b>7</b> GAM with interaction terms</a><ul>
<li class="chapter" data-level="7.1" data-path="gam-with-interaction-terms.html"><a href="gam-with-interaction-terms.html#interaction-between-smoothed-and-factor-variables"><i class="fa fa-check"></i><b>7.1</b> Interaction between smoothed and factor variables</a></li>
<li class="chapter" data-level="7.2" data-path="gam-with-interaction-terms.html"><a href="gam-with-interaction-terms.html#interaction-between-smoothed-variables"><i class="fa fa-check"></i><b>7.2</b> Interaction between smoothed variables</a></li>
</ul></li>
<li class="part"><span><b>Generalization of additive models</b></span></li>
<li class="chapter" data-level="8" data-path="gam-model-checking.html"><a href="gam-model-checking.html"><i class="fa fa-check"></i><b>8</b> GAM model checking</a><ul>
<li class="chapter" data-level="8.1" data-path="gam-model-checking.html"><a href="gam-model-checking.html#selecting-k"><i class="fa fa-check"></i><b>8.1</b> Selecting <span class="math inline">\(k\)</span></a><ul>
<li class="chapter" data-level="8.1.1" data-path="gam-model-checking.html"><a href="gam-model-checking.html#is-our-model-wiggly-enough"><i class="fa fa-check"></i><b>8.1.1</b> Is our model wiggly enough?</a></li>
<li class="chapter" data-level="8.1.2" data-path="gam-model-checking.html"><a href="gam-model-checking.html#is-our-model-actually-normal"><i class="fa fa-check"></i><b>8.1.2</b> Is our model actually Normal?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>9</b> Other distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="other-distributions.html"><a href="other-distributions.html#challenge-3"><i class="fa fa-check"></i><b>9.1</b> Challenge 3</a><ul>
<li class="chapter" data-level="9.1.1" data-path="other-distributions.html"><a href="other-distributions.html#challenge-3-solution"><i class="fa fa-check"></i><b>9.1.1</b> Challenge 3: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="changing-the-basis-function.html"><a href="changing-the-basis-function.html"><i class="fa fa-check"></i><b>10</b> Changing the basis function</a></li>
<li class="chapter" data-level="11" data-path="other-distributions-1.html"><a href="other-distributions-1.html"><i class="fa fa-check"></i><b>11</b> Other distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="other-distributions-1.html"><a href="other-distributions-1.html#visualizing-the-trend-over-time"><i class="fa fa-check"></i><b>11.1</b> Visualizing the trend over time</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="quick-intro-to-generalized-additive-mixed-models-gamms.html"><a href="quick-intro-to-generalized-additive-mixed-models-gamms.html"><i class="fa fa-check"></i><b>12</b> Quick intro to Generalized Additive Mixed Models (GAMMs)</a><ul>
<li class="chapter" data-level="12.1" data-path="quick-intro-to-generalized-additive-mixed-models-gamms.html"><a href="quick-intro-to-generalized-additive-mixed-models-gamms.html#dealing-with-non-independence"><i class="fa fa-check"></i><b>12.1</b> Dealing with non-independence</a></li>
<li class="chapter" data-level="12.2" data-path="quick-intro-to-generalized-additive-mixed-models-gamms.html"><a href="quick-intro-to-generalized-additive-mixed-models-gamms.html#mixed-modelling"><i class="fa fa-check"></i><b>12.2</b> Mixed modelling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>13</b> Resources</a></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 8: Generalized additive models in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="other-distributions-1" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Other distributions</h1>
<p>To provide a brief overview on how to use GAMs when the response
variable does not follow a normal distributions and is either count or
proportion data (e.g., Gamma, binomial, Poisson, negative binomial), the
example that follows uses a dataset where a binomial family distribution
is needed and a non-linear relationship with the explanatory variable is
evident. Here, the response variable represents the number of successes
(event happened) versus failures over the course of an experiment.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="other-distributions-1.html#cb95-1"></a>gam_data3 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;other_dist.csv&quot;</span>)</span>
<span id="cb95-2"><a href="other-distributions-1.html#cb95-2"></a><span class="kw">summary</span>(gam_data3)</span>
<span id="cb95-3"><a href="other-distributions-1.html#cb95-3"></a><span class="kw">str</span>(gam_data3)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;: 514 obs. of  4 variables:
 $ prop : num  1 1 1 1 0 1 1 1 1 1 ...
 $ total: int  4 20 20 18 18 18 20 20 20 20 ...
 $ x1   : int  550 650 750 850 950 650 750 850 950 550 ...
 $ fac  : Factor w/ 4 levels &quot;f1&quot;,&quot;f2&quot;,&quot;f3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p><code>prop</code> is the response variable, and is equal to the proportion of
<em>successes / (successes + failures)</em>. Note that there are numerous cases
where the proportion equals 1 or 0 which indicates that the outcomes
were always successes or failures, respectively, at a given time point
in the experiment.</p>
<p><code>x1</code> is the time since the start of experiment (our explanatory
variable).</p>
<p><code>total</code> represents the number of <em>successes + failures</em> observed at any
time point of the experiment.</p>
<p><code>fac</code> is a factor coding for trials 1 through 4 of the experiment (we
will not use this variable in this section).</p>
<p>Letâ€™s start by visualizing the data. We are interested in the number of
successes in comparison to failures as <code>x1</code> increases. We will calculate
the grand averages of the proportions of successes per time bin (<code>x1</code>)
given that there are repeated measures per <code>x1</code> value (numerous trials and
observations per trial).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="other-distributions-1.html#cb97-1"></a><span class="kw">emptyPlot</span>(<span class="kw">range</span>(gam_data3<span class="op">$</span>x1), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">h =</span> <span class="fl">0.5</span>, <span class="dt">main =</span> <span class="st">&quot;Probability of successes&quot;</span>,</span>
<span id="cb97-2"><a href="other-distributions-1.html#cb97-2"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x1&quot;</span>)</span>
<span id="cb97-3"><a href="other-distributions-1.html#cb97-3"></a></span>
<span id="cb97-4"><a href="other-distributions-1.html#cb97-4"></a>avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(prop <span class="op">~</span><span class="st"> </span>x1, <span class="dt">data =</span> gam_data3, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb97-5"><a href="other-distributions-1.html#cb97-5"></a><span class="kw">lines</span>(avg<span class="op">$</span>x1, avg<span class="op">$</span>prop, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/graphic1_otherdist.jpg" width="450" /></p>
<p>As <code>x1</code> increases, so does the probability of successes. Would you say
that this trend is linear or non-linear? We will test this using a
logistic GAM (we use a <code>binomial</code> family distribution given that our
response is proportion data).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="other-distributions-1.html#cb98-1"></a>prop_model &lt;-<span class="st"> </span><span class="kw">gam</span>(prop <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x1), <span class="dt">data =</span> gam_data3, <span class="dt">weights =</span> total,</span>
<span id="cb98-2"><a href="other-distributions-1.html#cb98-2"></a>    <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb98-3"><a href="other-distributions-1.html#cb98-3"></a>prop_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(prop_model)</span>
<span id="cb98-4"><a href="other-distributions-1.html#cb98-4"></a><span class="kw">print</span>(prop_summary<span class="op">$</span>p.table)</span>
<span id="cb98-5"><a href="other-distributions-1.html#cb98-5"></a><span class="kw">print</span>(prop_summary<span class="op">$</span>s.table)</span>
<span id="cb98-6"><a href="other-distributions-1.html#cb98-6"></a></span>
<span id="cb98-7"><a href="other-distributions-1.html#cb98-7"></a><span class="kw">plot</span>(prop_model)</span></code></pre></div>
<pre><code>             Estimate  Std. Error  z value   Pr(&gt;|z|)
(Intercept)  1.173978  0.02709613  43.32641  0

        edf       Ref.df    Chi.sq     p-value
s(x1)   4.591542  5.615235  798.9407   2.027751e-164</code></pre>
<p>What does the intercept represent in this model?</p>
<ul>
<li>Recall that the model uses the count outcomes to calculate the
<em>logit</em>, which is the log odds ratio between successes and failures:</li>
</ul>
<p><span class="math display">\[logit = log(\frac{N_{success}}{N_{failures}})\]</span></p>
<ul>
<li>If successes = failures, the ratio is 1 and the logit is 0 (i.e., log(1) =
0).</li>
<li>If successes have a larger count than failures, the ratio is greater
than 1 and the logit has a positive value (e.g., log(2) = 0.69).</li>
<li>If successes have a smaller count than failures, the ratio is lower
than 1 and the logit has a negative value (e.g., log(0.5) = -0.69).</li>
</ul>
<p>Thus, the intercept is the log odds ratio of successes to failures
(logit), and indicates whether on average there are more successes than
failures. Here, the estimated intercept coefficient is positive, which
means that there are more successes than failures overall.</p>
<p>What does the smooth term indicate?</p>
<ul>
<li>This represents how the log odds of successes vs failures changes
over <code>x1</code> (time in this example). So, we see that since the <em>edf&gt;1</em>,
the proportion of successes increases faster over time. If, for
example, the response represents the count of species A versus
species B and nutrient concentrations are increased over time,
these results would indicate that species A is increasingly observed
as nutrient concentrations approach its niche optima over the course
of the experiment.</li>
</ul>
<div id="visualizing-the-trend-over-time" class="section level2">
<h2><span class="header-section-number">11.1</span> Visualizing the trend over time</h2>
<p>Lastly, we will see the different ways this relationship could be
represented graphically.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="other-distributions-1.html#cb100-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb100-2"><a href="other-distributions-1.html#cb100-2"></a><span class="kw">plot</span>(prop_model, <span class="dt">select =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">0</span>, <span class="dt">shade =</span> <span class="ot">TRUE</span>)</span>
<span id="cb100-3"><a href="other-distributions-1.html#cb100-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</span>
<span id="cb100-4"><a href="other-distributions-1.html#cb100-4"></a></span>
<span id="cb100-5"><a href="other-distributions-1.html#cb100-5"></a>out &lt;-<span class="st"> </span><span class="kw">plot_smooth</span>(prop_model, <span class="dt">view =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb100-6"><a href="other-distributions-1.html#cb100-6"></a>(diff &lt;-<span class="st"> </span><span class="kw">find_difference</span>(out<span class="op">$</span>fv<span class="op">$</span>fit, out<span class="op">$</span>fv<span class="op">$</span>CI, <span class="dt">xVals =</span> out<span class="op">$</span>fv<span class="op">$</span>x1))</span>
<span id="cb100-7"><a href="other-distributions-1.html#cb100-7"></a><span class="kw">addInterval</span>(<span class="dv">0</span>, <span class="dt">lowVals =</span> diff<span class="op">$</span>start, <span class="dt">highVals =</span> diff<span class="op">$</span>end, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb100-8"><a href="other-distributions-1.html#cb100-8"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-9"><a href="other-distributions-1.html#cb100-9"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(diff<span class="op">$</span>start, diff<span class="op">$</span>end), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb100-10"><a href="other-distributions-1.html#cb100-10"></a><span class="kw">text</span>(<span class="kw">mean</span>(<span class="kw">c</span>(diff<span class="op">$</span>start, diff<span class="op">$</span>end)), <span class="fl">2.1</span>, <span class="st">&quot;sign. more </span><span class="ch">\n</span><span class="st"> success&quot;</span>,</span>
<span id="cb100-11"><a href="other-distributions-1.html#cb100-11"></a>    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">font =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="images/graphic2_otherdist.jpg" width="800" /></p>
<p>What do these plots tell us about successes versus failures?</p>
<ul>
<li>Left plot: contribution/ partial effect (if we had more than one
explanatory variable). Over time the log odds increases, so over
time successes increase and failures decrease.</li>
<li>Right plot: fitted values, intercept included (summed effect if we
had more than one explanatory variable included in the model). Here
we see that the log odds ratio is estimated around zero at the start
of the experiment; this means there are equal amounts of successes
and failures. Gradually successes increase, and at around <code>x1</code> = 400
there are significantly more successes than failures (the smooth is
significantly different from zero). We also illustrated how we could
use the plot to determine at which <code>x1</code> value this occurs.</li>
</ul>
<p>Lastly, to help interpret the results, we could transform the summed
effects back to proportions with the function <code>plot_smooth</code> from the
<code>itsadug</code> package:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="other-distributions-1.html#cb101-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb101-2"><a href="other-distributions-1.html#cb101-2"></a><span class="kw">plot_smooth</span>(prop_model, <span class="dt">view =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">transform =</span> plogis,</span>
<span id="cb101-3"><a href="other-distributions-1.html#cb101-3"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb101-4"><a href="other-distributions-1.html#cb101-4"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.5</span>, <span class="dt">v =</span> diff<span class="op">$</span>start, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/graphic3_otherdist.jpg" width="450" /></p>
<p>As we already derived from the logit plot, we see that at around <code>x1</code> = 400
the proportion of successes increases significantly above 0.5.</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="changing-the-basis-function.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quick-intro-to-generalized-additive-mixed-models-gamms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
